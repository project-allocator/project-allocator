# Project Allocator v3

Welcome to Project Allocator v3!

This is the repository that contains:

* Backend code for the project allocator.
* GitHub workflow to build and push the Docker image to GHCR.
    * Which will be consumed by the `project-allocator-deploy` repository.

## Tech Stack

* React with TypeScript
* Vite for development server
* Yarn for package manager
* Ant Design for UI components
* Tailwind CSS for custom styling
* React Router v6 for routing

## Code Structure

* `public/`
    * Contains public assets like favicon
* `src/`
    * `api/`
        * API client auto-generated by `openapi-typescript-codegen`
        * Do not modify files in this directory
    * `components/`
        * Contains shared UI layouts and components e.g. `ProjectForm`
    * `contexts/`
        * `ConfigContext.tsx`
            * React context for loading configuration from the backend's `config.yaml` via API
        * `MessageContext.tsx`
            * React context for showing popup messages at the bottom right of the screen
        * `UserContext.tsx`
            * React context for providing information for the currently logged-in user
    * `pages/`
        * Contains pages
    * `routes/`
        * Contains routes (guards)
        * Allows page access based on user role etc.
    * `index.css`
        * Contains global CSS code
    * `auth.ts`
        * Sets up `msal-react` to authenticate users with Microsoft SSO
    * `utils.ts`
        * Contains utility functions for case conversion etc.
    * `main.tsx`
        * Main entry point for the frontend
        * Sets up routes (mapping URLs to pages) and contexts
* `.env`
    * Sets up environment variables for local development
    * Environment variables for production development are provided via Appvia Wayfinder
* `Dockerfile`
    * Dockerfile for local development
* `Dockerfile.production`
    * Dockerfile for production on Azure
    * Takes security constraints of Appvia Wayfinder into account
* `config.yaml`
    * Configuration for the Project Allocator
    * See the deployment repository for more details

## Development Guide

### Updating API endpoints

When you update your backend API endpoints, make sure to run `yarn run generate` to auto-generate the API client.

If the hot reload fails, you need to restart the frontend container by:

1. `cd` into `project-allocator-deploy`.
2. Run `docker-compose restart frontend`.
